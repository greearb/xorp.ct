#
# $XORP: xorp/rib/Jamfile,v 1.3 2007/04/20 07:17:46 pavlin Exp $
#

SubDir TOP rib ;
SubIncludeOnce TOP libxorp ;
SubIncludeOnce TOP libcomm ;
SubIncludeOnce TOP xrl interfaces ;
SubIncludeOnce TOP xrl targets ;
SubIncludeOnce TOP libxipc ;
SubIncludeOnce TOP libproto ;
SubIncludeOnce TOP libfeaclient ;
SubIncludeOnce TOP mrt ;
SubIncludeOnce TOP cli ;
SubIncludeOnce TOP policy backend ;
SubIncludeOnce TOP policy common ;
SubDir TOP rib ;

Library librib :
	profile_vars.cc protocol.cc
	register_server.cc
	rib.cc rib_manager.cc rib_varrw.cc
	route.cc
	rt_tab_base.cc rt_tab_deletion.cc rt_tab_extint.cc
	rt_tab_log.cc rt_tab_merged.cc rt_tab_origin.cc
	rt_tab_pol_conn.cc rt_tab_pol_redist.cc rt_tab_redist.cc
	rt_tab_register.cc
	vifmanager.cc xrl_target.cc
	;

Library libribxrl : redist_xrl.cc ;

LINKLIBS_RIB_COMMON =
	librib
	libribxrl
	libfeaclient
	libfeaifmgrmirrorxif
	libfeaifmgrreplicatorxif
	libftixif
	libribclientxif
	libfindereventnotifierxif
	libredist4xif
	libredist6xif
	libredisttransaction4xif
	libredisttransaction6xif
	libpolicyredist4xif
	libpolicyredist6xif
	libprofileclientxif
	libfeaifmgrmirrorbase
	libribbase
	libpolicybackend
	libpolicycommon
	libproto
	libfinder
	libxipc
	libcomm
	libxorp
	;

Main xorp_rib : main_rib.cc ;
LinkLibraries xorp_rib : $(LINKLIBS_RIB_COMMON) ;

Main add_route : add_route.cc ;
LinkLibraries add_route : libribxif $(LINKLIBS_RIB_COMMON) ;

Main main_routemap : main_routemap.cc routemap.cc ;
LinkLibraries main_routemap : $(LINKLIBS_RIB_COMMON) ;

if $(MAKE_CHECK) {

 Library libribcheck : dummy_register_server.cc parser.cc ;

 Main test_deletion : test_deletion.cc rt_tab_expect.cc ;
 LinkLibraries test_deletion : $(LINKLIBS_RIB_COMMON) ;

 Main test_redist : test_redist.cc ;
 LinkLibraries test_redist : $(LINKLIBS_RIB_COMMON) ;

 Main test_register : test_register.cc ;
 LinkLibraries test_register : libribcheck $(LINKLIBS_RIB_COMMON) ;

 Main test_register_xrls : test_register_xrls.cc ;
 LinkLibraries test_register_xrls :
	libribxif
	libribclientbase
	$(LINKLIBS_RIB_COMMON)
	;

 Main test_rib_direct : test_rib_direct.cc ;
 LinkLibraries test_rib_direct : libribcheck $(LINKLIBS_RIB_COMMON) ;

 Main test_rib_xrls : test_rib_xrls.cc ;
 LinkLibraries test_rib_xrls :
	libribcheck
	libribxif
	libribclientbase
	$(LINKLIBS_RIB_COMMON)
	;
} # MAKE_CHECK

InstallBin $(PREFIX)/rib : xorp_rib ;

SubIncludeOnce TOP rib tools ;
